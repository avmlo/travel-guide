import{u as R,a as A,r as a,j as e,H as j,b as V,Z as U,d as _,D as B,Y as G,s as r,t as n}from"./index-DMrgTe9s.js";import{L as I,P as M}from"./plus-CR8lq-28.js";import{T as W}from"./trash-2-S9LPGSck.js";function J(){const c=R(),[,u]=A(),[t,w]=a.useState(null),[o,p]=a.useState([]),[l,y]=a.useState(null),[k,S]=a.useState(!0),[m,g]=a.useState(!1),[q,x]=a.useState(0),[D,f]=a.useState(null),[C,v]=a.useState(!1),b=l&&t&&l.id===t.user_id;a.useEffect(()=>{async function i(){const{data:{session:s}}=await r.auth.getSession();y(s?.user||null)}i()},[]),a.useEffect(()=>{async function i(){if(!c.id)return;const{data:s,error:d}=await r.from("lists").select(`
          *,
          user_profiles!lists_user_id_fkey (
            username,
            display_name
          )
        `).eq("id",c.id).single();if(d||!s){console.error("Error fetching list:",d),n.error("List not found"),u("/lists");return}if(!s.is_public&&(!l||l.id!==s.user_id)){n.error("This list is private"),u("/lists");return}const P={...s,owner_username:s.user_profiles?.username,owner_display_name:s.user_profiles?.display_name};w(P);const{data:N,error:L}=await r.from("list_items").select("*").eq("list_id",c.id).order("created_at",{ascending:!1});if(L)console.error("Error fetching list items:",L);else if(N&&N.length>0){const h=N.map(H=>H.destination_slug),{data:E,error:$}=await r.from("destinations").select("*").in("slug",h);!$&&E&&p(E)}if(l){const{data:h}=await r.from("list_likes").select("*").eq("list_id",c.id).eq("user_id",l.id).single();g(!!h)}const{count:T}=await r.from("list_likes").select("*",{count:"exact",head:!0}).eq("list_id",c.id);x(T||0),S(!1)}i()},[c.id,l,u]);async function F(){if(!l){n.error("Please sign in to like lists");return}if(t)if(m){const{error:i}=await r.from("list_likes").delete().eq("list_id",t.id).eq("user_id",l.id);i?n.error("Failed to unlike"):(g(!1),x(s=>s-1))}else{const{error:i}=await r.from("list_likes").insert({list_id:t.id,user_id:l.id});i?n.error("Failed to like"):(g(!0),x(s=>s+1),n.success("Added to liked lists"))}}async function O(i){if(!t)return;const{error:s}=await r.from("list_items").delete().eq("list_id",t.id).eq("destination_slug",i);s?n.error("Failed to remove from list"):(p(o.filter(d=>d.slug!==i)),n.success("Removed from list"))}return k?e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:200",className:"min-h-screen bg-white",children:[e.jsxDEV(j,{"data-loc":"client/src/pages/ListDetail.tsx:201"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:201,columnNumber:9},this),e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:202",className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:203",className:"text-center",children:e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:204",className:"animate-pulse text-gray-400",children:"Loading list..."},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:204,columnNumber:13},this)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:203,columnNumber:11},this)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:202,columnNumber:9},this),e.jsxDEV(V,{"data-loc":"client/src/pages/ListDetail.tsx:207"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:207,columnNumber:9},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:200,columnNumber:7},this):t?e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:217",className:"min-h-screen bg-white",children:[e.jsxDEV(j,{"data-loc":"client/src/pages/ListDetail.tsx:218"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:218,columnNumber:7},this),e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:220",className:"max-w-6xl mx-auto px-6 md:px-10 py-12",children:[e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:222",className:"mb-12",children:e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:223",className:"flex items-start justify-between mb-4",children:[e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:224",className:"flex-1",children:[e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:225",className:"flex items-center gap-3 mb-2",children:[e.jsxDEV("h1",{"data-loc":"client/src/pages/ListDetail.tsx:226",className:"text-4xl font-normal",children:t.name},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:226,columnNumber:17},this),t.is_public?e.jsxDEV(U,{"data-loc":"client/src/pages/ListDetail.tsx:228",className:"h-5 w-5 text-gray-400"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:228,columnNumber:19},this):e.jsxDEV(I,{"data-loc":"client/src/pages/ListDetail.tsx:230",className:"h-5 w-5 text-gray-400"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:230,columnNumber:19},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:225,columnNumber:15},this),t.description&&e.jsxDEV("p",{"data-loc":"client/src/pages/ListDetail.tsx:235",className:"text-gray-600 mb-4 max-w-2xl",children:t.description},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:235,columnNumber:17},this),e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:238",className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxDEV("span",{"data-loc":"client/src/pages/ListDetail.tsx:239",children:["By"," ",e.jsxDEV("button",{"data-loc":"client/src/pages/ListDetail.tsx:241",onClick:()=>t.owner_username&&u(`/user/${t.owner_username}`),className:"hover:underline font-medium",children:t.owner_display_name||t.owner_username||"Unknown"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:241,columnNumber:19},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:239,columnNumber:17},this),e.jsxDEV("span",{"data-loc":"client/src/pages/ListDetail.tsx:248",children:"•"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:248,columnNumber:17},this),e.jsxDEV("span",{"data-loc":"client/src/pages/ListDetail.tsx:249",children:[o.length," ",o.length===1?"place":"places"]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:249,columnNumber:17},this),t.is_public&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("span",{"data-loc":"client/src/pages/ListDetail.tsx:252",children:"•"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:252,columnNumber:21},this),e.jsxDEV("span",{"data-loc":"client/src/pages/ListDetail.tsx:253",className:"flex items-center gap-1",children:[e.jsxDEV(_,{"data-loc":"client/src/pages/ListDetail.tsx:254",className:`h-4 w-4 ${m?"fill-red-500 text-red-500":""}`},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:254,columnNumber:23},this),q]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:253,columnNumber:21},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:251,columnNumber:19},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:238,columnNumber:15},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:224,columnNumber:13},this),e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:263",className:"flex gap-2",children:[t.is_public&&e.jsxDEV("button",{"data-loc":"client/src/pages/ListDetail.tsx:265",onClick:F,className:`flex items-center gap-2 px-4 py-2 border transition-colors ${m?"border-red-500 text-red-500 hover:bg-red-50":"border-gray-300 hover:border-black"}`,children:[e.jsxDEV(_,{"data-loc":"client/src/pages/ListDetail.tsx:273",className:`h-4 w-4 ${m?"fill-current":""}`},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:273,columnNumber:19},this),e.jsxDEV("span",{"data-loc":"client/src/pages/ListDetail.tsx:274",children:m?"Liked":"Like"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:274,columnNumber:19},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:265,columnNumber:17},this),b&&e.jsxDEV("button",{"data-loc":"client/src/pages/ListDetail.tsx:279",onClick:()=>u("/lists"),className:"px-4 py-2 border border-gray-300 hover:border-black transition-colors",children:"Manage Lists"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:279,columnNumber:17},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:263,columnNumber:13},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:223,columnNumber:11},this)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:222,columnNumber:9},this),o.length===0?e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:292",className:"text-center py-24",children:[e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:293",className:"mb-6",children:e.jsxDEV(M,{"data-loc":"client/src/pages/ListDetail.tsx:294",className:"h-16 w-16 text-gray-300 mx-auto"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:294,columnNumber:15},this)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:293,columnNumber:13},this),e.jsxDEV("h3",{"data-loc":"client/src/pages/ListDetail.tsx:296",className:"text-xl font-normal mb-2",children:"No destinations yet"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:296,columnNumber:13},this),e.jsxDEV("p",{"data-loc":"client/src/pages/ListDetail.tsx:297",className:"text-gray-600",children:b?"Start adding destinations to this list":"This list is empty"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:297,columnNumber:13},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:292,columnNumber:11},this):e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:302",className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:o.map(i=>e.jsxDEV("div",{"data-loc":"client/src/pages/ListDetail.tsx:304",className:"relative group",children:[e.jsxDEV(B,{"data-loc":"client/src/pages/ListDetail.tsx:305",destination:i,onClick:()=>{f(i),v(!0)}},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:305,columnNumber:17},this),b&&e.jsxDEV("button",{"data-loc":"client/src/pages/ListDetail.tsx:314",onClick:s=>{s.stopPropagation(),O(i.slug)},className:"absolute top-2 right-2 p-2 bg-white hover:bg-red-50 text-red-600 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxDEV(W,{"data-loc":"client/src/pages/ListDetail.tsx:321",className:"h-4 w-4"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:321,columnNumber:21},this)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:314,columnNumber:19},this)]},i.slug,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:304,columnNumber:15},this))},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:302,columnNumber:11},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:220,columnNumber:7},this),e.jsxDEV(V,{"data-loc":"client/src/pages/ListDetail.tsx:330"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:330,columnNumber:7},this),D&&e.jsxDEV(G,{"data-loc":"client/src/pages/ListDetail.tsx:334",destination:D,isOpen:C,onClose:()=>{v(!1),f(null)}},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:334,columnNumber:9},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/ListDetail.tsx",lineNumber:217,columnNumber:5},this):null}export{J as default};
