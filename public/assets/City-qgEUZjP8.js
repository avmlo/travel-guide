import{a as S,W as _,r as i,j as e,H as L,D as I,b as P,Y as q,s as m}from"./index-DYbaPiT3.js";function A(d){return d.split("-").map(c=>c.charAt(0).toUpperCase()+c.slice(1)).join(" ")}function U(){const[,d]=S(),[,c]=_("/city/:city"),n=c?.city||"",[x,h]=i.useState([]),[N,f]=i.useState(!0),[y,v]=i.useState(null),[C,p]=i.useState(!1),[D,k]=i.useState([]),[E,j]=i.useState([]),[O,w]=i.useState(null),[l,g]=i.useState("");i.useEffect(()=>{async function t(){const{data:{session:a}}=await m.auth.getSession();if(w(a?.user||null),a?.user){const{data:u}=await m.from("saved_places").select("destination_slug").eq("user_id",a.user.id);u&&k(u.map(s=>s.destination_slug));const{data:o}=await m.from("visited_places").select("destination_slug").eq("user_id",a.user.id);o&&j(o.map(s=>s.destination_slug))}}t()},[]),i.useEffect(()=>{async function t(){const{data:a,error:u}=await m.from("destinations").select("*").eq("city",n).order("name");if(!u&&a){const o=a.map(s=>({name:s.name,slug:s.slug,city:s.city,category:s.category,content:s.content||s.description||"",mainImage:s.image||"",michelinStars:s.michelin_stars||0,crown:s.crown||!1,brand:"",cardTags:"",lat:0,long:0,myRating:0,reviewed:!1,subline:s.description||""}));h(o)}f(!1)}n&&t()},[n]);const V=t=>{v(t),p(!0)},b=Array.from(new Set(x.map(t=>t.category))).sort(),r=l?x.filter(t=>t.category===l):x;return N?e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:115",className:"min-h-screen bg-white dark:bg-gray-950 flex items-center justify-center transition-colors duration-300",children:e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:116",className:"text-xs font-bold uppercase text-black/60 dark:text-white/60",children:"Loading..."},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:116,columnNumber:9},this)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:115,columnNumber:7},this):e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:122",className:"min-h-screen bg-white dark:bg-gray-950 transition-colors duration-300",children:[e.jsxDEV(L,{"data-loc":"client/src/pages/City.tsx:123"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:123,columnNumber:7},this),e.jsxDEV("main",{"data-loc":"client/src/pages/City.tsx:126",className:"px-6 md:px-10 py-12",children:e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:127",className:"max-w-[1920px] mx-auto",children:[e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:129",className:"mb-6",children:e.jsxDEV("button",{"data-loc":"client/src/pages/City.tsx:130",onClick:()=>d("/cities"),className:"text-xs font-bold uppercase text-black/60 dark:text-white/60 hover:opacity-60 transition-opacity",children:"â† CITIES"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:130,columnNumber:13},this)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:129,columnNumber:11},this),e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:139",className:"mb-12",children:[e.jsxDEV("h1",{"data-loc":"client/src/pages/City.tsx:140",className:"text-[clamp(24px,5vw,48px)] font-bold uppercase leading-none tracking-tight mb-4 text-black dark:text-white",children:A(n)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:140,columnNumber:13},this),e.jsxDEV("p",{"data-loc":"client/src/pages/City.tsx:143",className:"text-xs font-bold uppercase text-black/60 dark:text-white/60",children:[r.length," ",r.length===1?"destination":"destinations"]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:143,columnNumber:13},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:139,columnNumber:11},this),b.length>1&&e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:150",className:"mb-8",children:[e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:151",className:"mb-3",children:e.jsxDEV("h2",{"data-loc":"client/src/pages/City.tsx:152",className:"text-xs font-bold uppercase text-black dark:text-white",children:"Categories"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:152,columnNumber:17},this)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:151,columnNumber:15},this),e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:154",className:"flex flex-wrap gap-x-4 gap-y-2",children:[e.jsxDEV("button",{"data-loc":"client/src/pages/City.tsx:155",onClick:()=>g(""),className:`text-xs font-bold uppercase transition-opacity ${l?"text-black/30 dark:text-white/30 hover:opacity-60":"text-black dark:text-white"}`,children:"ALL"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:155,columnNumber:17},this),b.map(t=>e.jsxDEV("button",{"data-loc":"client/src/pages/City.tsx:164",onClick:()=>g(t===l?"":t),className:`text-xs font-bold uppercase transition-opacity ${l===t?"text-black dark:text-white":"text-black/30 dark:text-white/30 hover:opacity-60"}`,children:t},t,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:164,columnNumber:19},this))]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:154,columnNumber:15},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:150,columnNumber:13},this),r.length===0?e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:180",className:"text-center py-20",children:[e.jsxDEV("p",{"data-loc":"client/src/pages/City.tsx:181",className:"text-xs font-bold uppercase text-black/40 dark:text-white/40",children:"No destinations found."},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:181,columnNumber:15},this),l&&e.jsxDEV("button",{"data-loc":"client/src/pages/City.tsx:185",onClick:()=>g(""),className:"mt-4 text-xs font-bold uppercase text-black dark:text-white hover:opacity-60 transition-opacity",children:"Clear filter"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:185,columnNumber:17},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:180,columnNumber:13},this):e.jsxDEV("div",{"data-loc":"client/src/pages/City.tsx:194",className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 2xl:grid-cols-7 gap-4 md:gap-6",children:r.map((t,a)=>e.jsxDEV(I,{"data-loc":"client/src/pages/City.tsx:196",destination:t,colorIndex:a,onClick:()=>V(t),isSaved:D.includes(t.slug),isVisited:E.includes(t.slug)},t.slug,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:196,columnNumber:17},this))},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:194,columnNumber:13},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:127,columnNumber:9},this)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:126,columnNumber:7},this),e.jsxDEV(P,{"data-loc":"client/src/pages/City.tsx:210"},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:210,columnNumber:7},this),e.jsxDEV(q,{"data-loc":"client/src/pages/City.tsx:213",destination:y,isOpen:C,onClose:()=>p(!1)},void 0,!1,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:213,columnNumber:7},this)]},void 0,!0,{fileName:"/home/ubuntu/travel-guide/client/src/pages/City.tsx",lineNumber:122,columnNumber:5},this)}export{U as default};
